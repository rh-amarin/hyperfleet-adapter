# Cluster Controller Deployment Template
apiVersion: apps/v1
kind: Deployment
metadata:
  name: "cluster-controller-{{ .clusterId }}"
  namespace: "cluster-{{ .clusterId }}"
  labels:
    hyperfleet.io/cluster-id: "{{ .clusterId }}"
    hyperfleet.io/component: "controller"
spec:
  replicas: 1
  selector:
    matchLabels:
      hyperfleet.io/cluster-id: "{{ .clusterId }}"
      hyperfleet.io/component: "controller"
  template:
    metadata:
      labels:
        hyperfleet.io/cluster-id: "{{ .clusterId }}"
        hyperfleet.io/component: "controller"
    spec:
      containers:
        - name: controller
          image: "quay.io/hyperfleet/controller:{{ .imageTag }}"
          env:
            - name: CLUSTER_ID
              value: "{{ .clusterId }}"
            - name: RESOURCE_ID
              value: "{{ .resourceId }}"
          resources:
            requests:
              cpu: "100m"
              memory: "128Mi"
            limits:
              cpu: "500m"
              memory: "512Mi"

